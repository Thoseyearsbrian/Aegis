# > Project Name：SurgeAegis - Surge Personal Digital Firewall Rule Set

# > Current Version：1.0.9

# > Last Updated：2025-10-03

# > Supported Environment：Surge 5（iOS / macOS）

# > 配置作者：ThoseYearsBrian

# > 项目主页：https://github.com/Thoseyearsbrian/Aegis

[General]

# > Log Level

loglevel = notify
show-error-page-for-reject = true

# > Allow Wi-Fi Access

allow-wifi-access = false

# > All Hybrid Network Concurrency

all-hybrid = false

# > Test Timeout (seconds)

test-timeout = 3

# > Internet Test URL

internet-test-url = http://www.aliyun.com

# > Proxy Test URL

proxy-test-url = http://cp.cloudflare.com/generate_204

# > GeoIP Database

geoip-maxmind-url = https://raw.githubusercontent.com/Thoseyearsbrian/GeoIP2-CN/main/data/GeoLite2-Country.mmdb

# > Exclude Simple Hostnames

exclude-simple-hostnames = true

# > Remote Controller (Recommended: Off)

http-api-web-dashboard = false

# > IPv6 Support (Recommended: Off)

ipv6 = false

# > IPv6 VIF (Recommended: Disable)

ipv6-vif = disabled

# > DNS SVCB/HTTPS Query (Recommended: Off)

allow-dns-svcb = false

# > Include Local Networks

include-local-networks = true

# > Exclude Apple Push Services from Proxy (Recommended: Off)

include-apns = false

# > Include Cellular Services (Recommended: Off)

include-cellular-services = false

# > Read DNS records from /etc/hosts first (static resolution to prevent DNS leak)

read-etc-hosts = true

# > Encrypted DNS Follows Outbound Proxy (Recommended: Off)

encrypted-dns-follow-outbound-mode = false

# > DNS Servers

encrypted-dns-server = h3://dns.alidns.com/dns-query,https://dns.alidns.com/dns-query, tls://dns.alidns.com, h3://cloudflare-dns.com/dns-query, tls://1.1.1.1, tls://1.0.0.1, https://dns.cloudflare.com/dns-query
hijack-dns = 8.8.8.8:53, 8.8.4.4:53, 114.114.114.114:53, 114.114.115.115:53, 223.5.5.5:53, 223.6.6.6:53, 1.1.1.1:53, 1.0.0.1:53, 9.9.9.9:53, 149.112.112.112:53, 208.67.222.222:53, 208.67.220.220:53, 180.76.76.76:53, 119.29.29.29:53 ,192.168.50.1:53

# > Prioritize UDP (Recommended: On)

udp-priority = true

# > UDP Priority Mode (Gaming Mode, Recommended: On)

include-all-networks = true

# > Take Over All Network Interfaces (e.g., virtual NIC, shared network)

udp-policy-not-supported-behaviour = DIRECT

# > UDP Fallback Behavior

skip-proxy = 127.0.0.1, localhost, *.local, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 100.64.0.0/10, e.crashlytics.com, captive.apple.com, ::ffff:0:0:0:0/1, ::ffff:128:0:0:0:0/1

# > If connected Wi-Fi is not the primary one in Surge, use default policy

always-real-ip = msftconnecttest.com, msftncsi.com, *.msftconnecttest.com, *.msftncsi.com, *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, *.battlenet.com.cn, *.battlenet.com, *.blzstatic.cn, *.battle.net

# > Skip Proxy for Local Addresses and Key Services

compatibility-mode = false

# > Allow GEOIP Auto Update

disable-geoip-db-auto-update = false

[Proxy Group]

# > Policy Groups (The nodes listed below must correspond to those in the external nodes section. If a node is deleted from the external section, it must also be removed from the policy group.)

Node Selection = select, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", "✈️ My Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Surge.png
Google Services = select, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Google.png
YouTube Video = select, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/YouTube.png
Netflix Streaming = select, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Netflix.png
AI Assistant = select, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main//Icons/Services/ChatGPT.png
GitHub = select, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/GitHub.png
Telegram = select, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Telegram.png
Crypto = sselect, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Crypto.png
Disney+ = select, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Disney.png
International Media = select, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node",icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/ForeignMedia.png
Microsoft = select, DIRECT, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Microsoft.png
Apple Services = select, DIRECT, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Apple.png
Bilibili = select, DIRECT, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Bilibili.png
Mainland China Media = select, DIRECT, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/iQIYI.png
Gaming Platforms = select, DIRECT, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Game.png

# > External Nodes

🇭🇰 Hong Kong Node = smart, include-other-group=✈️ My Node, update-interval=true, no-alert=true, hidden=1, include-all-proxies=true, policy-regex-filter=(🇭🇰)|(Hong Kong)|(Hong)|(HK), icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Flags/hk.png
🇺🇲 United States Node = smart, include-other-group=✈️ My Node, update-interval=true, no-alert=true, hidden=1, include-all-proxies=true, policy-regex-filter=(🇺🇸)|(United States)|(States)|(US), icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Flags/us.png
🇯🇵 Japan Node = smart, include-other-group=✈️ My Node, update-interval=0, no-alert=true, hidden=1, include-all-proxies=true, policy-regex-filter=(🇯🇵)|(Japan)|(Japan)|(JP), icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Flags/jp.png
🇨🇳 Taiwan Node = smart, include-other-group=✈️ My Node, update-interval=0, no-alert=true, hidden=1, include-all-proxies=true, policy-regex-filter=(🇨🇳)|(Taiwan)|(Tai)|(TW), icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Flags/cn.png
🇸🇬 Singapore Node = smart, include-other-group=✈️ My Node, update-interval=0, no-alert=true, hidden=1, include-all-proxies=true, policy-regex-filter=(🇸🇬)|(Singapore)|(Singapore)|(SG), icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Flags/sg.png
✈️ My Node = select, DIRECT, policy-path=Your Subscribed Nodes, update-interval=86400, no-alert=true, hidden=false, include-all-proxies=true, icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Final.png

[Rule]

# This project is a fully personal-maintained Surge network security rule set, aimed at helping global users build their own local network defense systems, enhancing the ability to identify and block DNS poisoning, APT attacks, and malicious IP traffic. We adhere to principles of technical neutrality, information transparency, and independent autonomy. We do not accept any form of capital injection, commercial investment, or monetization cooperation to ensure the neutrality, fairness, and independence of the project.
# > Monitoring / Auditing / DPI and Other High-Risk Node Blocking Rules – Includes airport nodes, suspicious open ports, abnormal VPS behavior, DPI activities, and segments suspected of GFW operations. (Blocking is recommended)

# Advanced Module: CA_Block.list (commented out by default, manually enable if needed)
# RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/CA_Block.list,REJECT,no-resolve

# > Ad Blocking

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/AdTracking_Block.list,REJECT,no-resolve

# > High-risk node blocking rules for monitoring / auditing / DPI, etc. — Involving airport proxy nodes, suspicious open ports, abnormal VPS usage behavior, DPI / suspected GFW operations (recommended to block)

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Inspection_Block.list,REJECT,no-resolve

# > Behavioral Fingerprinting & Cloud Service Analysis – Blocking based on behavioral patterns such as DNS query characteristics and TLS fingerprints (e.g., Client Hello), combined with identification of grey-market SDKs and analytics nodes (recommended to block).

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Behavior_Block.list,REJECT,no-resolve

# > Suspicious Background Services and Domains – Unrelated to specific devices, includes callback/listening/unknown-purpose services and third-party SDKs (recommended to block).

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Background_Block.list,REJECT,no-resolve

# > Known backconnect domains, spoofed updates, DNS poisoning callbacks, and other malicious activity patterns (recommended to block)

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Backdoor_Block.list,REJECT,no-resolve

# > Botnets / Controller IPs – Suggested to block

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Botnet_Block.list,REJECT,no-resolve

# > APT Threat Source Blocking Rules – Based on threat intelligence (APT1 ~ APTxx naming convention) (Recommended to block)

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/APT_Block.list,REJECT,no-resolve

# > Pegasus Spyware Domains – Derived from public threat intelligence sources such as Amnesty International and Citizen Lab (Recommended to block)

// All credit goes to the Amnesty International team. I do not intend to profit or steal the limelight. This rule set was created purely out of goodwill for community protection.
// All domains were extracted from the Pegasus investigation report and formatted for the SurgeAegis project.
// Original data source: https://www.amnesty.org/en/latest/research/2021/07/pegasus-project/
// This rule set will be continuously maintained. Community contributions of up-to-date IOCs are welcome.

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Pegasus_Block.list,REJECT,no-resolve

# > AI Assistant

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/OpenAI.list,AI Assistant

# > Apple Services

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Apple.list,Apple Services

# > Github

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/GitHub.list,GitHub

# > Crypto

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Crypto.list,Crypto

# > Microsoft

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Microsoft.list,Microsoft

# > Google Services

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Google.list,Google Services

# > Social Platforms

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Telegram.list,Telegram

# > Gaming Platforms

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/GamePlatforms.list ,Gaming Platforms

# > Streaming Media

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/YouTube.list,YouTube Video
RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Netflix.list,Netflix Streaming
RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/DisneyPlus.list,Disney+
RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Bilibili.list,Bilibili
RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/ChinaMedia.list,Mainland China Media
RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/GlobalMedia.list,International Media

# > Proxy

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Proxy.list,Node Selection

# > China

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/China.list, DIRECT

# > Local Area Network Addresses

RULE-SET,LAN,DIRECT

# > GEOIP Match for Mainland China

GEOIP,CN,DIRECT

# > Final Rule

FINAL,REJECT

[Host]

# > IPv6 loopback mapping

ip6-localhost = ::1

# > Local Router Login & Hotspot Identification (No need to specify DNS, leave it to system resolution)

routerlogin.net = system
router.asus.com = system
amplifi.lan = system
*.lan = system
_hotspot_.m2m = system
hotspot.cslwifi.com = system