# > Project Name：Aegis - Personal Digital Firewall Ruleset for Surge

# > Current Version：1.1.6

# > Last Updated：2025-10-25

# > Supported Environment：Surge 5（iOS / macOS）

# > Configuration Author：ThoseYearsBrian

# > Project Homepage：https://github.com/Thoseyearsbrian/Aegis

[General]

# > Log Level

loglevel = notify
show-error-page-for-reject = true

# > Allow Wi-Fi Access (LAN proxy sharing, recommended OFF)
allow-wifi-access = false

# > Allow Personal Hotspot Access (hotspot proxy sharing, recommended OFF)
allow-hotspot-access = false

# > All Hybrid Network Concurrency

all-hybrid = false

# > Test Timeout (seconds)

test-timeout = 3

# > Internet Test URL

internet-test-url = http://www.aliyun.com

# > Proxy Test URL

proxy-test-url = http://cp.cloudflare.com/generate_204

# > GeoIP Database

geoip-maxmind-url = https://raw.githubusercontent.com/Thoseyearsbrian/GeoIP2-CN/main/data/GeoLite2-Country.mmdb

# > Exclude Simple Hostnames (to prevent local hostname leakage)

exclude-simple-hostnames = true

# > Remote Controller (Recommended: Off)

http-api-web-dashboard = false

# > IPv6 Support (Recommended: Off)

ipv6 = false

# > IPv6 VIF (Recommended: Disable)

ipv6-vif = disabled

# > DNS SVCB/HTTPS Query (Recommended: Off)

allow-dns-svcb = false

# > Include Local Networks (recommended to enable; set to false if features like AirDrop, Bonjour, or Handoff do not work properly)

include-local-networks = true

# > Exclude Apple Push Services from Proxy (set to true to include iCloud and notification traffic in proxy routing)

include-apns = true

# > Include Cellular Services (set to true to bypass ISP DNS hijacking)

include-cellular-services = true

# > Read DNS records from /etc/hosts first (static resolution to prevent DNS leak)

read-etc-hosts = true

# > Encrypted DNS Follows Outbound Proxy (Recommended: Off)

encrypted-dns-follow-outbound-mode = false

# > DNS Servers

encrypted-dns-server = https://dns.alidns.com/dns-query, tls://dns.alidns.com, tls://1.1.1.1, tls://1.0.0.1, https://dns.cloudflare.com/dns-query
hijack-dns = *:53

# > Prioritize UDP (Recommended: On)

udp-priority = true

# > UDP Priority Mode (Gaming Mode, Recommended: On)

include-all-networks = true

# > Take Over All Network Interfaces (e.g., virtual NIC, shared network)

udp-policy-not-supported-behaviour = DIRECT

# > UDP Fallback Behavior

skip-proxy = 127.0.0.1, localhost, *.local, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 100.64.0.0/10, 224.0.0.0/4, 239.0.0.0/8

# > If connected Wi-Fi is not the primary one in Surge, use default policy

always-real-ip = *.local, *.lan, *.home, msftconnecttest.com, msftncsi.com, *.msftconnecttest.com, *.msftncsi.com, *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, *.battlenet.com.cn, *.battlenet.com, *.blzstatic.cn, *.battle.net

# > Skip Proxy for Local Addresses and Key Services

compatibility-mode = false

# > Allow GEOIP Auto Update

disable-geoip-db-auto-update = false

[Proxy Group]

# > Policy Groups (The nodes listed below must correspond to those in the external nodes section. If a node is deleted from the external section, it must also be removed from the policy group.)

Node Selection = select, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", "✈️ My Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Surge.png
Google Services = select, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Google.png
AI Assistant = select, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main//Icons/Services/ChatGPT.png
GitHub = select, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/GitHub.png
Telegram = select, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Telegram.png
Crypto = select, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Crypto.png
International Media = select, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node",icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/ForeignMedia.png
Mainland China Media = select, DIRECT, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/iQIYI.png
Microsoft = select, DIRECT, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Microsoft.png
Apple Services = select, DIRECT, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Apple.png
Gaming Platforms = select, DIRECT, Node Selection, "🇭🇰 Hong Kong Node", "🇺🇲 United States Node", "🇸🇬 Singapore Node", "🇯🇵 Japan Node", "🇨🇳 Taiwan Node", icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Game.png

# > External Nodes

🇭🇰 Hong Kong Node = smart, include-other-group=✈️ My Node, update-interval=true, no-alert=true, hidden=1, include-all-proxies=true, policy-regex-filter=(🇭🇰)|(Hong Kong)|(Hong)|(HK), icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Flags/hk.png
🇺🇲 United States Node = smart, include-other-group=✈️ My Node, update-interval=true, no-alert=true, hidden=1, include-all-proxies=true, policy-regex-filter=(🇺🇸)|(United States)|(States)|(US), icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Flags/us.png
🇯🇵 Japan Node = smart, include-other-group=✈️ My Node, update-interval=0, no-alert=true, hidden=1, include-all-proxies=true, policy-regex-filter=(🇯🇵)|(Japan)|(Japan)|(JP), icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Flags/jp.png
🇨🇳 Taiwan Node = smart, include-other-group=✈️ My Node, update-interval=0, no-alert=true, hidden=1, include-all-proxies=true, policy-regex-filter=(🇨🇳)|(Taiwan)|(Tai)|(TW), icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Flags/cn.png
🇸🇬 Singapore Node = smart, include-other-group=✈️ My Node, update-interval=0, no-alert=true, hidden=1, include-all-proxies=true, policy-regex-filter=(🇸🇬)|(Singapore)|(Singapore)|(SG), icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Flags/sg.png
✈️ My Node = select, policy-path=Your Subscribed Nodes, update-interval=86400, no-alert=true, hidden=false, include-all-proxies=true, icon-url=https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/Icons/Services/Final.png

[Rule]

# This project is a fully independently maintained Surge network security rule set.
# It aims to help global users build localized personal network defense systems,
# enhancing the ability to detect and block DNS pollution, APT threats, and malicious traffic.
# We adhere to principles of technical neutrality, information transparency, and independent autonomy,
# and believe that everyone deserves the right to know and control their network traffic.
# This project does not accept any form of capital control or commercial investment.
# All configuration files are manually written and audited by the author, with complete annotations,
# ensuring that every blocking rule is open, authentic, controllable, and free from contamination.
# Any financial support, if any, is based solely on voluntary donation,
# to safeguard the independence, fairness, and security of the project.

# ① Untrusted Certificate Authorities — CA_Block.list (Advanced Module · Commented by Default · User-activated)

# RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/CA_Block.list,REJECT,no-resolve

# > ② Ad Block

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/AdTracking_Block.list,REJECT,no-resolve

# > ③ Adult Block

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Adult_Block.list,REJECT,no-resolve

# > ④ Interception of Surveillance Nodes

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Inspection_Block.list,REJECT,no-resolve

# ⑤ Behavioral Analysis and Telemetry Node Interception

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Behavior_Block.list,REJECT,no-resolve

# > ⑥ Background Callback and Silent Communication Node Blocking

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Background_Block.list,REJECT,no-resolve

# > ⑦ Backdoor Command and Implant Communication Node Blocking

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Backdoor_Block.list,REJECT,no-resolve

# > ⑧ Botnet Infrastructure and Command Node Blocking

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Botnet_Block.list,REJECT,no-resolve

# > ⑨ APT Threat Source Blocking – Intelligence-Driven (Custom APT1–APTxx Format)

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/APT_Block.list,REJECT,no-resolve

# > ⑩ Pegasus Spyware Communication Node Blocking – Based on Public Intelligence (Amnesty, Citizen Lab, etc.)

// All credit goes to the Amnesty International team. I do not intend to profit or steal the limelight. This rule set was created purely out of goodwill for community protection.
// All domains were extracted from the Pegasus investigation report and formatted for the SurgeAegis project.
// Original data source: https://www.amnesty.org/en/latest/research/2021/07/pegasus-project/
// This rule set will be continuously maintained. Community contributions of up-to-date IOCs are welcome.

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Pegasus_Block.list,REJECT,no-resolve

# > AI Assistant

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/OpenAI.list,AI Assistant

# > Apple Services

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Apple.list,Apple Services

# > Github

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/GitHub.list,GitHub

# > Crypto

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Crypto.list,Crypto

# > Microsoft

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Microsoft.list,Microsoft

# > Google Services

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Google.list,Google Services

# > Social Platforms

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Telegram.list,Telegram

# > Gaming Platforms

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/GamePlatforms.list ,Gaming Platforms

# > Streaming Media

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/ChinaMedia.list,Mainland China Media
RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/GlobalMedia.list,International Media

# > Proxy

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/Proxy.list,Node Selection

# > China

RULE-SET,https://raw.githubusercontent.com/Thoseyearsbrian/Aegis/main/rules/China.list, DIRECT

# > Local Area Network Addresses

RULE-SET,LAN,DIRECT

# > GEOIP Match for Mainland China

GEOIP,CN,DIRECT

# > Final Rule

FINAL,REJECT

[Host]

# > IPv6 loopback mapping

ip6-localhost = ::1

# > Local Router Login & Hotspot Identification (No need to specify DNS, leave it to system resolution)

routerlogin.net = system
router.asus.com = system
amplifi.lan = system
*.lan = system
_hotspot_.m2m = system
hotspot.cslwifi.com = system